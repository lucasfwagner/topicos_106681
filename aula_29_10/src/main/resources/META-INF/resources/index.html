<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
    <title>Sistema de Biblioteca Digital</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1, h2 { color: #2c3e50; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .card { display: inline-block; padding: 15px; margin: 10px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9; min-width: 150px; }
        .card-title { font-weight: bold; font-size: 1.1em; margin-bottom: 5px; }
    </style>
</h:head>

<h:body>
    <h1>üìö Sistema de Biblioteca Digital</h1>
    <h2>Demonstra√ß√£o de Relacionamentos JPA</h2>

    <!-- Estat√≠sticas -->
    <div>
        <div class="card">
            <div class="card-title">Total de Livros</div>
            <div>#{bibliotecaBean.totalLivros}</div>
        </div>
        <div class="card">
            <div class="card-title">Livros Dispon√≠veis</div>
            <div>#{bibliotecaBean.livrosDisponiveis}</div>
        </div>
        <div class="card">
            <div class="card-title">Empr√©stimos Ativos</div>
            <div>#{bibliotecaBean.emprestimosAtivosCount}</div>
        </div>
        <div class="card">
            <div class="card-title">Total de Autores</div>
            <div>#{bibliotecaBean.totalAutores}</div>
        </div>
    </div>

    <h:form>
        <!-- Tabela de Autores -->
        <h2>Autores</h2>
        <table>
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>Email</th>
                    <th>Quantidade de Livros</th>
                </tr>
            </thead>
            <tbody>
                <ui:repeat value="#{bibliotecaBean.autores}" var="autor">
                    <tr>
                        <td>#{autor.nome}</td>
                        <td>#{autor.email}</td>
                        <td>#{autor.livros.size()}</td>
                    </tr>
                </ui:repeat>
            </tbody>
        </table>

        <!-- Tabela de Livros -->
        <h2>Livros</h2>
        <table>
            <thead>
                <tr>
                    <th>T√≠tulo</th>
                    <th>Autor</th>
                    <th>ISBN</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <ui:repeat value="#{bibliotecaBean.livros}" var="livro">
                    <tr>
                        <td>#{livro.titulo}</td>
                        <td>#{livro.autor.nome}</td>
                        <td>#{livro.isbn}</td>
                        <td>#{livro.disponivel ? 'Dispon√≠vel' : 'Emprestado'}</td>
                    </tr>
                </ui:repeat>
            </tbody>
        </table>

        <!-- Tabela de Empr√©stimos Ativos -->
        <h2>Empr√©stimos Ativos</h2>
        <table>
            <thead>
                <tr>
                    <th>Usu√°rio</th>
                    <th>Email</th>
                    <th>Livro</th>
                    <th>Data Empr√©stimo</th>
                    <th>Data Prevista</th>
                </tr>
            </thead>
            <tbody>
                <ui:repeat value="#{bibliotecaBean.emprestimosAtivos}" var="emprestimo">
                    <tr>
                        <td>#{emprestimo.nomeUsuario}</td>
                        <td>#{emprestimo.emailUsuario}</td>
                        <td>#{emprestimo.livro.titulo}</td>
                        <td>#{emprestimo.dataEmprestimo}</td>
                        <td>#{emprestimo.dataDevolucaoPrevista}</td>
                    </tr>
                </ui:repeat>
            </tbody>
        </table>
    </h:form>
</h:body>
</html>
